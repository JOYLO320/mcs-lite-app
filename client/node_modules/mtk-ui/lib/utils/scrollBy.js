'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _rafLoop = require('raf-loop');

var _rafLoop2 = _interopRequireDefault(_rafLoop);

var _emptyFunction = require('fbjs/lib/emptyFunction');

var _emptyFunction2 = _interopRequireDefault(_emptyFunction);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var inOutQuintic = function inOutQuintic(currentTime, b, change, d) {
  var t = currentTime;
  t /= d / 2;
  if (t < 1) {
    return change / 2 * t * t + b;
  }

  t--;
  return -change / 2 * (t * (t - 2) - 1) + b;
};

/**
 * Scroll with RequestAnimationFrame
 * ref: https://gist.github.com/james2doyle/5694700
 *
 * @param {node} [node = document.body] 要滾動的對象
 *
 * @param {Object}
 * @param {number} [Object.offsetX = 0]
 * @param {number} [Object.offsetY = 0]
 * @param {number} [Object.duration = 500]
 * @param {func} [callback = emptyFunction]
 *
 * @return {func}
 *
 * @author Michael Hsu
 */

var scrollBy = function scrollBy() {
  var node = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : document.body;
  return function (_ref) {
    var _ref$offsetX = _ref.offsetX,
        offsetX = _ref$offsetX === undefined ? 0 : _ref$offsetX,
        _ref$offsetY = _ref.offsetY,
        offsetY = _ref$offsetY === undefined ? 0 : _ref$offsetY,
        _ref$duration = _ref.duration,
        duration = _ref$duration === undefined ? 500 : _ref$duration;
    var callback = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : _emptyFunction2.default;

    var startX = node.scrollLeft;
    var startY = node.scrollTop;
    var currentTime = 0;

    var animateScroll = function animateScroll(increment) {
      currentTime += increment;
      node.scrollLeft = inOutQuintic(currentTime, startX, offsetX, duration);
      node.scrollTop = inOutQuintic(currentTime, startY, offsetY, duration);
    };

    // RequestAnimationFrame Start
    var engine = (0, _rafLoop2.default)(function () {
      animateScroll(20);
      if (currentTime >= duration) {
        engine.stop();
        callback();
      }
    }).start();
  };
};

exports.default = scrollBy;
module.exports = exports['default'];