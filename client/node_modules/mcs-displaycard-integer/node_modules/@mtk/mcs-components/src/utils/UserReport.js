/**
 * Setup UserReport service
 * @param {string} API_KEY - User voice website id.
 *
 * @output {object} UserReport (global)
 *
 * @author Michael Hsu
 */

export default class UserReport {
  constructor({ API_KEY }) {
    this.API_KEY = API_KEY;
  }

  renderScript() {
    const ur = document.createElement('script');
    ur.type = 'text/javascript';
    ur.async = true;
    ur.src = ('//cdn.userreport.com/userreport.js');
    const s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(ur, s);
  }

  setup() {
    this.renderScript();

    // Must use user report SDK as global
    global._urq = window._urq || [];
    global._urq.push(['initSite', this.API_KEY]);

    return this;
  }

  show() {
    global._urq.push(['Feedback_Open', 'submit/bug']);
  }
}
