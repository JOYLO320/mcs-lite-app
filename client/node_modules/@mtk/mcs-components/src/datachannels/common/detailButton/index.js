import { default as React, PropTypes } from 'react';
import { withState, compose, setPropTypes, withAttachedProps, pure } from 'recompose';
import { default as Menu } from 'mtk-ui/lib/Menu';
import { default as MenuItem } from 'mtk-ui/lib/MenuItem';

import { MiMoreVert } from 'mtk-icon';
import { default as styles } from './styles/main.css';
import { default as c } from 'classnames';
import { default as iconStyle } from '../icon/styles/main.css';

const detailButton = ({ onClick, active, config, defaultSelectedValue, ...props }) => {
  return (
    <a onClick={onClick} {...props}>
      <MiMoreVert className={iconStyle.icon}/>
      {
        active ?
        <Menu
          className={styles.menu}
          selectedValue={defaultSelectedValue}
        >
          {config.map((key) => <MenuItem value={key.value} children={key.children} />)}
        </Menu> : ''
      }
    </a>
  );
};

export default compose(
  setPropTypes({
    config: PropTypes.object.isRequired,
  }),
  pure,
  withState('active', 'onClick', false),
  withAttachedProps((getProps) => ({
    config: getProps().config || [{
      value: 'history',
      children: 'history',
    }],
    className: c(
      iconStyle.base,
      getProps().className,
    ),
    onClick: () => getProps().onClick((value) => !value),
  })),
)(detailButton);
